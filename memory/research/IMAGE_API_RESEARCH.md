# 自拍生成方案调研报告

## 📊 方案对比

### 1. 阿里云百炼（当前方案）
**状态**: ❌ 已欠费

**优点**:
- 生成质量好
- API 稳定
- 支持负向提示词

**缺点**:
- 收费较高（约 0.08元/张）
- 快速消耗额度
- 需要持续充值

**成本估算**: 100张 ≈ 8元

---

### 2. Stability AI（待测试）
**API**: stability.ai

**优点**:
- 生成质量优秀
- 支持 SDXL 模型
- 有免费额度

**缺点**:
- 需要代理访问
- 免费额度有限

**成本**: 免费额度 + 付费

**测试方案**:
```bash
# 需要检查是否有 API Key
# 需要代理
```

---

### 3. Pollinations.ai（已配置但被 Cloudflare 封锁）
**状态**: ❌ 不可用

**优点**:
- 完全免费
- 无需 API Key

**缺点**:
- Cloudflare 封锁
- 国内无法访问

---

### 4. Hugging Face Inference API
**API**: huggingface.co

**优点**:
- 免费额度充足
- 多种模型可选
- 支持 Stable Diffusion

**缺点**:
- 需要代理
- 速度较慢

**配置检查**:
```bash
# 检查 HF_TOKEN
env | grep HF_TOKEN
```

---

### 5. 本地部署 Stable Diffusion
**方案**: 本地运行 SD 模型

**优点**:
- 完全免费
- 无限制使用
- 隐私安全

**缺点**:
- 需要显卡（服务器无显卡）
- 生成速度慢
- 占用资源

**可行性**: ❌ 服务器无 GPU

---

### 6. Replicate API
**API**: replicate.com

**优点**:
- 多种模型
- 按使用付费
- 质量好

**缺点**:
- 需要付费
- 需要代理

**成本**: 按秒计费

---

### 7. 字节跳动火山引擎
**API**: volcengine.com

**优点**:
- 国内服务，速度快
- 有免费额度
- 支持中文提示词

**缺点**:
- 需要注册
- 免费额度有限

**测试方案**: 需要检查是否有账号

---

## 🎯 推荐方案

### 优先级排序

**P0 - 立即可用**:
1. ✅ **Hugging Face** - 有免费额度，已配置
2. ✅ **火山引擎** - 国内服务，可能有免费额度

**P1 - 需要配置**:
3. ⚠️ **Stability AI** - 需要代理和 API Key
4. ⚠️ **Replicate** - 需要注册和付费

**P2 - 备选方案**:
5. 🔄 **切换到文本生成** - 暂时用文字描述
6. 🔄 **使用现有照片** - 不再生成新照片

---

## 📝 测试计划

### 步骤 1: 检查 Hugging Face
- 检查 API Key 是否有效
- 测试生成效果
- 评估可行性

### 步骤 2: 检查火山引擎
- 查看是否有账号
- 测试免费额度
- 评估成本

### 步骤 3: 混合方案
- 高质量场景用付费 API
- 普通场景用免费 API
- 批量生成时选择低成本方案

---

## 💡 成本优化建议

1. **按需生成** - 只在御主要求时生成
2. **批量生成** - 一次生成多张，减少 API 调用
3. **质量分级** - 不同场景用不同质量的模型
4. **缓存复用** - 相似场景复用已有照片

---

*调研时间: 2026-02-26*
*状态: 进行中*
*创建任务ID: 从 /tmp/current_task_id 读取*
